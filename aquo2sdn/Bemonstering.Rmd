# Bemonstering

```{r}
require(tidyverse)
require(data.table)
require(stringr)
# Lees functie in voor download domeintabellen
source("c:/git_checkouts/Accessing-MediaWiki-Aquo-Code-Examples/ExampleCodeRStudio/GetDomainTable.R")
# source_url("https://github.com/Aquo-standaard/Accessing-MediaWiki-Aquo-Code-Examples/blob/main/ExampleCodeRStudio/GetDomainTable.R")


```


## Bemonsteringsapparaat of Veldapparaat

```{r}
idsw_aquo_bemonsteringsapparaat <- GetDomainTable(pDomeintabel <- "Bemonsteringsapparaat")
0
idsw_aquo_bemonsteringsapparaat %>% select(Omschrijving) %>% 
  knitr::kable(caption = 'Lijst met bemonsteringsapparaten in AQUO domeintabel "bemonsterinsapparaat"')
```


BODC onderhoudt verschillende tabellen waar bemonsteringsapparaten in voorkomen. De meest gedetailleerde tabel is de [SeaVoX Device Catalogue L22](http://vocab.nerc.ac.uk/collection/L22/current/). Een minder gedetailleerde (broader) tabel is [SeaDataNet device category](http://vocab.nerc.ac.uk/collection/L05/current/).

De mapping die hier gepresenteerd wordt is slechts 


```{r bodcBemonsteringsapparaat}
bodc_sdn_bemonsteringsapparaat <- read_delim(file.path("aquo2sdn\\data\\bodc\\vocab_l22.csv"), delim = ";")

bodc_sdn_bemonsteringsapparaat %>% 
  head() %>%
  select(conceptid, preflabel) %>%
  knitr::kable(caption = "Eerste elementen van BODC L22 tabel SeaVoX Device Catalogue.")
```

In eerdere transformaties van Nederlandse data naar EMODnet Biologie zijn wel eens mappings gemaakt. Hieruit is de ad hoc handmatige mapping hieronder samengesteld. 


```{r}

bemonsteringsapparaat_mapping <- idsw_aquo_bemonsteringsapparaat %>%
  mutate(
    bodc_code = case_when(
      Omschrijving == "Box-corer"  ~ 'http://vocab.nerc.ac.uk/collection/L22/current/TOOL1177/',
      Omschrijving == "Bodemschaaf"  ~ 'http://vocab.nerc.ac.uk/collection/L22/current/NETT0190/',
      Omschrijving == "Hamon happer"  ~  "http://vocab.nerc.ac.uk/collection/L22/current/TOOL0960/",   # to be added to BODC L22
      Omschrijving == "Video"  ~ 'http://vocab.nerc.ac.uk/collection/L05/current/180/',
      Omschrijving == "Van Veen happer"~ "http://vocab.nerc.ac.uk/collection/L22/current/TOOL0653/",
      Omschrijving == "Zuigkor"~ "http://vocab.nerc.ac.uk/collection/L05/current/64/",
      Omschrijving == "Boomkor"~ "http://vocab.nerc.ac.uk/collection/L22/current/TOOL0651/",
      Omschrijving == "Emmer"~ "http://vocab.nerc.ac.uk/collection/L22/current/TOOL0536/",
      Omschrijving == "Pomp"~ "http://vocab.nerc.ac.uk/collection/L22/current/NETT0173/",
      Omschrijving == "Pelagic trawl"~ "http://vocab.nerc.ac.uk/collection/L05/current/23/",
      Omschrijving == "Fuik"~ "http://vocab.nerc.ac.uk/collection/L05/current/63/",
      Omschrijving == "Piston-corer"~ "http://vocab.nerc.ac.uk/collection/L05/current/51/"
      Omschrijving == "Videocamera"~ "http://vocab.nerc.ac.uk/collection/L05/current/311/"
      Omschrijving == "VacuÃ¼m steekbuis"~ "http://vocab.nerc.ac.uk/collection/L05/current/391/"
      Omschrijving == "Pelagic trawl"~ "http://vocab.nerc.ac.uk/collection/L05/current/23/"
      Omschrijving == "Pelagic trawl"~ "http://vocab.nerc.ac.uk/collection/L05/current/23/"
      Omschrijving == "Pelagic trawl"~ "http://vocab.nerc.ac.uk/collection/L05/current/23/"
      
    )
  ) %>%
  select(
    aquo_omschrijving = Omschrijving,
    aquo_cijfercode = Cijfercode,
    bodc_code
  ) %>% 
  arrange(bodc_code)

bemonsteringsapparaat_mapping %>% knitr::kable()

```











## Bemonsteringsmethode

```{r}
idsw_aquo_bemonsteringsmethode <- GetDomainTable(pDomeintabel <- "Bemonsteringsmethode")

idsw_aquo_bemonsteringsmethode %>% select(Omschrijving) %>%
  knitr::kable()
```

Conclusie: Vooral Nederlandse methodieken. Best lastig te vergelijken met internationale codes. Even parkeren.



## Bemonsteringssoort

```{r}
idsw_aquo_Bemonsteringssoort <- GetDomainTable(pDomeintabel <- "Bemonsteringssoort")

idsw_aquo_Bemonsteringssoort %>% select(Omschrijving) %>%
  knitr::kable()
```


Mappen naar welke BODC tabel?



## Meetapparaat



## Kleur


## Kwaliteitsoordeel

In AQUO kunnen verschillende kwaliteitsoordelen worden toegekend aan een meetwaarde (tabel \@ref(tab:aquoKwaliteitsoordeel)). Het is niet eenvoudig om te bepalen welke codes in de praktijk worden toegepast. Het gebruik in de Data Distributielaag kan alleen bepaald worden wanneer data daadwerkelijk gedownloadt worden.



```{r aquoKwaliteitsoordeel}
idsw_aquo_kwaliteitsoordeel <- GetDomainTable(pDomeintabel <- "Kwaliteitsoordeel")

idsw_aquo_kwaliteitsoordeel %>% select(Codes, Omschrijving) %>%
  knitr::kable(caption = "Aquo kwaliteitsoordeelcodes en -omschrijvingen.")
```
De corresponderende tabel met algemene kwalititeitsoordelen van BODC is de tabel [L20](http://vocab.nerc.ac.uk/collection/L20/current/) (figuur \@ref(tab:bodcKwaliteitsoordeel)). BODC hanteert hiernaast tabellen met  meer specifieke "quality flags" voor bepaalde apparaten of organisaties (IODE). Hier gaan we nu niet verder op in. 




```{r bodcKwaliteitsoordeel}
bodc_sdn_kwaliteitsoordeel <- read_delim(file.path("aquo2sdn\\data\\bodc\\vocab_l20.csv"), delim = ";")

bodc_sdn_kwaliteitsoordeel %>% select(conceptid, preflabel, definition) %>%
  knitr::kable()
```


In eerder werk (NWDM) is een mapping gemaakt op basis van data uit de DDL voor Noordzee en Waddenzee (fysische-chemische data). Het voorstel is om deze als basis te gebruiken. De tabel 

```{r readQualityCodeMappingTable}
L201_mapping <- read_delim(file.path("aquo2sdn\\data\\otherMappings\\Mapping_SDN_L201.csv"), delim = ";")
```

Dit


```{r Kwaliteitscodecomparison}
# compare verbose versions of AQUO and BODC
kwaliteitescodemapping <- L201_mapping %>% 
  mutate(SDN_L201_code = as.character(SDN_L201_code)) %>%
  full_join(idsw_aquo_kwaliteitsoordeel, by = c(Aquo_Kwaliteitsoordeel_code = "Codes")) %>%
  full_join(bodc_sdn_kwaliteitsoordeel, by = c(SDN_L201_code = "conceptid")) %>%
  select(aquo_code = Aquo_Kwaliteitsoordeel_code,
         aquo_omschrijving = Omschrijving,
         conceptid = SDN_L201_code,
         preflabel
         )

knitr::kable(kwaliteitescodemapping, caption = "Voorgestelde apping van kwaliteitscodes.")

```



## Statistischeparameter


## Waardebepalingsmethode


## Waardebepalingstechniek


## Waardebewerkingsmethode



## Biologie: Orgaan



## Biologie: Biologisch Kenmerk

